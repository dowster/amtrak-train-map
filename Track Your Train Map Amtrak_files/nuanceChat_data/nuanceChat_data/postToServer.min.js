function Logger(){this.enabled=!1;this.setEnabled=function(a){this.enabled=a};this.log=function(a){this._log("log",arguments)};this.debug=function(a){this._log("debug",arguments)};this.error=function(a){this._log("error",arguments,!0)};this._log=function(a,b,c){if(this.enabled||c){b=this._addPrefixToArguments(b);try{this._writeToConsole(a,b)}catch(d){}}};this._writeToConsole=function(a,b){var c="log";void 0!==console[a]&&(c=a);console[c].apply(console,b)};this._addPrefixToArguments=function(a){a=
this._convertArgumentsToArray(a);a.unshift("postToServer (origin: "+location.origin+"):");return a};this._convertArgumentsToArray=function(a){return Array.prototype.slice.call(a)}};var PersistentStorage=function(){function a(){var a=b()?d().getItem("PSConfiguration"):!1;logger.debug("Persistent storage configuration: "+a);if(!a||"localStorage"!==a&&"cookie"!==a){var a=!1,e=window.location.href;try{window.localStorage&&-1!=e.indexOf("clientHosted=true")&&(localStorage.setItem("inqPc",2),a=!0,logger.debug("Testing localStorage, inqPc=2 has been set"))}catch(f){logger.log("WARNING window.localStorage is not supported and chat may not be offered. "+f.message)}logger.debug("isClientHostedLS: "+
a+".");if(a)k="localStorage";else if(b())k="cookie";else{a=!1;if(/firefox/i.test(window.navigator.userAgent))try{window.localStorage&&(localStorage.setItem("inqPc",2),a=!0,logger.debug("Testing localStorage, inqPc=2 has been set"))}catch(f){logger.log("WARNING window.localStorage is not supported and chat may not be offered. "+f.message)}logger.debug("isLSSupported: "+a);a?k="localStorage":(null==n&&(n=b()||""===document.cookie?!1:!0),logger.debug("isCookieReadOnlyEnabled: "+n),n&&(k="cookie"))}}else k=
a;return"cookie"===k?d():"localStorage"===k?c():null}function b(){if("undefined"==typeof l){var a=(new Date((new Date).getTime()+316224E5)).toUTCString(),b="inqPc="+(Math.floor(9E6*Math.random())+1E6).toString(16),c=-1!==window.location.href.indexOf(m)?"domain="+m+";":"";logger.debug("Writing cookie inqPc to check if cookies are supported");document.cookie=b+"; SameSite=None; Secure; path=/; expires="+a+";"+c;l=-1!==document.cookie.indexOf(b);document.cookie="inqPc=; SameSite=None; Secure; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT; "+
c;logger.debug("Deleting cookie inqPc. cookiesEnabled: "+l)}return l}function c(a){var b=localStorage;a=a||"localStorage";"sessionStorage"==a&&(b=sessionStorage);var c={setValue:function(c,e,d){function f(c,e){b.setItem(c,e);var d=b.getItem(c);e.toString()!==d&&logger.debug(a+": Expected "+c+" to equal "+e+", but instead received: "+d)}logger.debug(a+": setValue("+c+", "+decodeURIComponent(e)+", "+d+")");f("LSCACHE-"+c,d);f(c,e)}};return{getAllCookies:function(c){var e="",d,f;try{for(var g in b)b.hasOwnProperty(g)&&
0!==g.indexOf("LSCACHE-")&&(d=this.getItem(g),0===g.indexOf("inqCA")&&(f=sessionStorage.getItem("sinqCA"),logger.debug("sessionStorage: getAllCookies() sessionCA: "+f),!isNaN(f)&&0<f&&(d=0)),e+=""+g+"="+d+";")}catch(p){logger.log("ERROR: Storage is not available. Can't get all data.")}logger.debug(a+": getAllCookies() returns: "+decodeURIComponent(e));c&&c(e);return e},get:function(c){var e={};try{for(var d in b)b.hasOwnProperty(d)&&0!==d.indexOf("LSCACHE-")&&(e[d]=b.getItem(d))}catch(f){logger.log("ERROR: Storage is not available. Can't get item for Safari.")}logger.debug(a+
": get() returns: "+JSON.stringify(e));c&&c(e);return e},getItem:function(c,e){var d=new Date;try{var f=b.getItem("LSCACHE-"+c);if(null!==f&&"session"!==f&&(f=parseInt(f,10),!isNaN(f)&&f<d.getTime()))return logger.debug(a+": expired and call removeItem("+c+")"),this.removeItem("LSCACHE-"+c),this.removeItem(c),e&&e(null),null;var g=b.getItem(c);logger.debug(a+": getItem("+c+") returns: "+decodeURIComponent(g));e&&e(g);return g}catch(p){logger.log("ERROR: Storage is not available. Can't get item.")}},
setItem:function(a,b,e,d){if("string"!==typeof a)throw new TypeError("key must be of type 'string'");if("undefined"!==typeof e&&""!==e){var f=new Date,g=parseInt(e,10);isNaN(g)?(e=Date.parse(e),isNaN(e)?logger.log("ERROR: PersistentStorage.cookieInstance: lifetime has to be a number or a date string"):e>f.getTime()?c.setValue(a,b,e):this.removeItem(a)):0<g?c.setValue(a,b,f.getTime()+g):this.removeItem(a)}else c.setValue(a,b,"session");d&&d()},removeItem:function(c,e){try{var d=function(c){b.removeItem(c);
var e=b.getItem(c);null!==e&&logger.log(a+": removeItem(): Expected "+c+" to equal null, but instead received: "+e)};logger.debug(a+": removeItem("+c+")");d("LSCACHE-"+c);d(c);e&&e()}catch(f){logger.log("ERROR: Storage is not available. Can't remove item.")}},clear:function(a){try{logger.debug("LOCALSTORAGE: clear()"),b.clear(),a&&a()}catch(c){logger.log("ERROR: Storage is not available. Can't clear.")}},cleanNuanceCookies:function(){},onUnload:function(c){var e=(new Date).getTime()+6E5;logger.debug(a+
": setSessionStorageTimeout(): SESSION_TIMEOUT="+e+"");for(var d in localStorage)0===d.indexOf("LSCACHE-")&&"session"===localStorage.getItem(d)&&b.setItem(d,e);c&&c()},version:"localStorage.0.0.3"}}function d(){return{getAllCookies:function(a){var b=document.cookie;logger.debug("getAllCookies(): "+b);a&&a(b);return b},get:function(a){var b=this.getAllCookies(),c=null;if(""!==b)for(var c={},b=b.split(";"),e=0;e<b.length;e++){var d=b[e],d=d.replace(/^\s+|\s+$/g,""),d=d.split("=");c[d[0]]=d[1]}a&&a(c);
logger.debug("cookie get(): "+JSON.stringify(c));return c},getItem:function(a,b){var c=this.get(),e=null;null!==c&&(e=c[a]);b&&b(e);logger.debug("cookie getItem(): "+a+"="+e);return e},setItem:function(a,b,c,e){var d="";if("undefined"===typeof c||""===c)d="";else if(d=parseInt(c,10),isNaN(d)){d=Date.parse(c);if(isNaN(d)){logger.log("ERROR: PersistentStorage.cookieInstance: days has to be a number or a date string");return}d=";expires="+c}else 0<d?(c=new Date,c.setTime(c.getTime()+d),d=";expires="+
c.toUTCString()):d=";expires=Thu, 01 Jan 1970 00:00:01 GMT";a=a+"="+b+d+"; SameSite=None; Secure; path=/"+(-1!=window.location.href.indexOf(m)?";domain="+m:"");this._setDocumentCookie(a);logger.debug("cookie setItem(): "+a);e&&e()},removeItem:function(a,b){logger.debug("cookie removeItem(): "+a);this.setItem(a,"",-1,b)},clear:function(a){logger.debug("cookie clear()");var b=this.get();if(null!==b)for(var b=Object.keys(b),c=0;c<b.length;c++){var e=b[c];this.removeItem(e,null,!0);this.removeItem(e,
null,!1)}a&&a()},onUnload:function(a){a&&a()},cleanNuanceCookies:function(){var a=this.get();if(null!==a)for(var a=Object.keys(a),b=0;b<a.length;b++){var c=a[b];/(inq|tc)[^_]*_\d*/.test(c)&&(this.removeItem(c,null,!0),this.removeItem(c,null,!1))}},_setDocumentCookie:function(a){document.cookie=a},version:"cookie.0.0.3"}}var e,f,g,h,k=null,l,n=null,m;return{setRootDomain:function(a){m=a},getInstance:function(b){if("localStorage"==b)return g||(g=c("localStorage")),g;if("sessionStorage"==b)return h||
(h=c("sessionStorage")),h;if("cookie"==b)return f||(f=d()),f;e||(e=a());return e},getDefaultUsedStorageType:function(){e||a();return k},_testHook:{getCookieInstance:d,getLocalStorageInstance:c}}}();var hasStringSupport=!1,xHRsInProgress={},caUnloadController,beaconUnloadController,targetOrigin,logger=new Logger;function simpleChatPost(a){var b=a.indexOf("?");if(-1!=b){var c=a.substring(0,b);a=a.substring(b+1);b=getXMLHttpRequest();b.open("POST",c,!0);b.setRequestHeader("Content-type","application/x-www-form-urlencoded");b.send(a)}}
function doCommandsInClientDomain(a,b){var c=[];"string"==typeof a?(c[0]=b,c[1]=a):c=a;hasStringSupport?parent.postMessage(convertArrToString(c),targetOrigin):parent.postMessage(c,targetOrigin);logger.debug("posted cross-window message: ",{command:c,targetOrigin:targetOrigin})}function convertArrToString(a){for(var b=0;b<a.length;b++)a[b]=encodeURIComponent(a[b]);return a.join("||")}
function assignCookieRootDomains(a){if(a){a=a.split(",");for(var b=0;b<a.length;b++)if(-1!==window.location.href.indexOf(a[b])){PersistentStorage.setRootDomain(a[b]);break}}}function _executeCommandFromItems(a){if(a&&0<a.length)try{if(checkDataForSimplePost(a))simpleChatPost(a[0]);else try{doCommands(a)}catch(b){handleError(a[1],b)}}catch(b){logger.error(b.message)}}function handleError(a,b){doCommandsInClientDomain({id:a,error:b},a)}
function checkDataForSimplePost(a){return/(^HTTP[s]?:).*/ig.test(a)}function whenLoaded(){if(-1!==location.search.indexOf("?CLEAR"))clearAllData();else try{window.addEventListener?window.addEventListener("message",whenPosted,!1):window.attachEvent?window.attachEvent("onmessage",whenPosted):window.onmessage=whenPosted}catch(a){logger.error(a.message)}}
function doBeaconCommand(a){function b(a,b,c){beaconUnloadController.activate();beaconUnloadController.set(a);beaconUnloadController.url=b;beaconUnloadController.complete=c}if("undefined"===typeof window.v3Lander){var c=a[1];beaconUnloadController||(beaconUnloadController=new UnloadController(function(a){beaconUnloadController.complete||(sendBeacon(beaconUnloadController.url,beaconUnloadController.get()),beaconUnloadController.complete=!0)}));"ACTIVATE"==c?b(a[2],a[3],!1):"DEACTIVATE"==c?beaconUnloadController.deactivate():
c&&-1<c.indexOf("activeWindowUnload")?b(a[5],a[4],!1):"DATA"==c&&beaconUnloadController.set(a[2])}}
function doCommands(a){var b=a[0];switch(b){case "ONLOAD":doOnloadCommand(a);break;case "ABORT":doAbortCommand(a);break;case "POSTCHAT":doPostChatCommand(a);break;case "SCBR3_PM":doSCBR3PMCommand(a);break;case "GCBR3":doGCBR3Command(a);break;case "COMMITPOINT":doCommitPointCommand(a);break;case "DUMP":doDumpCommand(a);break;case "POSTBR30":doPOSTBR30Command(a);break;case "POSTJSON":doPOSTJSONCommand(a);break;case "COBROWSE":doCobrowseCommand(a);break;case "CBAUTH":doCBAUTHCommand(a);break;case "CBCHECK":doCBCheckCommand(a);
break;case "CHATACTIVE":doChatActiveCommand(a);break;case "CHATDEACTIVATE":chatDeactivate(a);break;case "BEACON":doBeaconCommand(a);break;case "POSTSYNC":doPostSyncCommand(a);break;case "CLEARSTORAGE":doClearStorageCommand(a);break;default:3<a.length&&(a=a[1],b=Error("Undefined Request for ["+b+"] command"),b.name="Syntax Error",handleError(a,b))}}
function doOnloadCommand(a){a=a[1];logger.setEnabled(!1===a.JSLoggingDisabled);a.rootDomainsList&&assignCookieRootDomains(a.rootDomainsList);a.id&&doCommandsInClientDomain([a.id])};var xhrTimeoutController={},trustedDomain,COOKIE_COBROWSE="cobrowse";
function validateDomain(a,b,c){var d=getLocation().pathname;if(0===d.indexOf("/chatrouter")||0===d.indexOf("/cobrowse"))c(!0,a);else{var e;if(window.v3Lander){if("function"===typeof getV3LanderConfigProperty&&(e=getV3LanderConfigProperty("vanityDomain",v3Lander.vanityDomain)),!e){c(!0,a);return}}else e="https://"+getLocation().host;var f=getXMLHttpRequest(),d="origin="+encodeURIComponent(a);"undefined"!==typeof b&&(d+="&siteID="+encodeURIComponent(b));f.open("POST",e+"/tagserver/init/isTrustedDomain");
f.setRequestHeader("Content-Type","application/x-www-form-urlencoded");f.onreadystatechange=function(){4===f.readyState&&(406===f.status?c(!1):c(!0,a))};f.send(d)}}
function whenPosted(a){var b=a?a:event;logger.debug("received cross-window message: ",{data:b.data,origin:b.origin});if(b.source===window)logger.error("Source window is equal to current window, command won't be executed.");else{var c=b.data;c&&0<c.length?("string"===typeof c?(hasStringSupport=!0,c=c.split("||")):hasStringSupport=!1,void 0===trustedDomain?validateDomain(b.origin,c[2],function(a,e){trustedDomain=a;targetOrigin=e;a?_executeCommandFromItems(c):logger.log("not executing command: untrusted domain origin: "+
b.origin)}):trustedDomain&&targetOrigin===b.origin?_executeCommandFromItems(c):logger.log("not executing command: untrusted domain origin: "+b.origin)):logger.debug("There is no data in the message: ",{data:b.data,origin:b.origin})}}function setChatActiveFlag(a,b,c){caUnloadController&&caUnloadController.set(b);PersistentStorage.getInstance().setItem(a,b,c,function(){setSessionChatActiveFlagPS(b)})}
function getChatActiveFlag(a,b){if("function"!==typeof b)throw Error("Callback is required parameter for getChatActiveFlag function");PersistentStorage.getInstance().getItem(a,function(a){a=parseInt(a);isNaN(a)&&(a=0);b(a)})}
function setSessionChatActiveFlagPS(a){if("undefined"===typeof a||isNaN(a))logger.log("In setSessionChatActiveFlagPS(); requires one argument as a number");else try{"localStorage"===PersistentStorage.getDefaultUsedStorageType()&&sessionStorage.setItem("sinqCA",a)}catch(b){logger.log("Error while set sinqCA",b)}}function checkSameProtocolOrigin(a){return-1===a.indexOf(window.location.protocol)?a.replace(/^http:/i,window.location.protocol):a}
function pepareResponseData(a,b){var c=[];"unknown"!=typeof b.status?(c[0]=a,c[1]=b.responseText,c[2]=b.status,c[3]=b.getResponseHeader("Cache-Control")||"",c[4]=b.getResponseHeader("Content-Type")||""):c=[a,"","","",""];return c}function doAbortCommand(a){if("undefined"===typeof window.v3Lander&&(a=a[1],xHRsInProgress&&xHRsInProgress[a])){var b=xHRsInProgress[a];delete xHRsInProgress[a];b.abort()}}
function doPostChatCommand(a){var b=a[1],c=a[4],d=a[5],e=parseInt(a[6])||0;a=a[7];try{var f=getXMLHttpRequest();xHRsInProgress[b]=f;f.open(d?"POST":"GET",c,!0);void 0!=f.timeout?f.timeout=e:xhrTimeoutController[b]=setTimeoutXHR(e,b,xHRsInProgress);f.onreadystatechange=function(){4==f.readyState&&(xhrTimeoutController[b]&&(clearTimeout(xhrTimeoutController[b]),delete xhrTimeoutController[b]),xHRsInProgress[b]&&(doCommandsInClientDomain(pepareResponseData(b,f),b),delete xHRsInProgress[b]))};a&&f.setRequestHeader("X-Protection-Id",
encodeURIComponent(a));d?(f.setRequestHeader("Content-type","application/x-www-form-urlencoded"),f.send(decodeURIComponent(d))):f.send()}catch(g){handleError(b,g)}}function doSCBR3PMCommand(a){var b,c=a[1],d=a[2];try{var e=a[4],f=a[5];PersistentStorage.getInstance(a[6]).setItem(e+"_"+d,f,a[7]);b={action:"3rdPCQ"};doCommandsInClientDomain(JSON.stringify(b),c)}catch(g){handleError(c,g)}}
function doGCBR3Command(a){var b="",c=a[1],d=a[2];if(a=PersistentStorage.getInstance())try{d?a.getItem(d,function(a){b=d+"="+a;doCommandsInClientDomain(b,c)}):getAllData(function(a){""===a&&(a="inqPc=1");b=a;doCommandsInClientDomain(b,c)})}catch(e){handleError(c,e)}else doCommandsInClientDomain("no-cookie",c)}
function doCommitPointCommand(a){var b,c=a[1];a=a[2];var d=PersistentStorage.getInstance();try{d.getItem("inqVital_"+a,function(a){a=unescape(a);var d=/\bvcnt:([0-9]+)/.exec(a);d||(d=/\bvcnt":([0-9]+)/.exec(a));b={action:"W3rdCC",resp:2==d.length?d[1]:0};doCommandsInClientDomain(JSON.stringify(b),c)})}catch(e){handleError(c,e)}}
function doDumpCommand(a){if("undefined"===typeof window.v3Lander){var b=a[1];try{var c=decodeURIComponent(a[4]),d="_rand="+Math.round(0xe8d4a51001*Math.random()).toString(36)+"&level=info&line=document.cookie: "+encodeURIComponent("REMOVED FROM LOG FOR SECURITY REASONS"),e=getXMLHttpRequest();xHRsInProgress[b]=e;e.open("POST",c,!0);e.onreadystatechange=function(){4==e.readyState&&(delete xHRsInProgress[b],doCommandsInClientDomain("",b))};e.setRequestHeader("Content-type","application/x-www-form-urlencoded");
e.send(d)}catch(f){handleError(b,f)}}}
function doPOSTBR30Command(a){var b=a[1];try{var c=decodeURIComponent(a[4]),d=c.indexOf("?"),e=c.substring(0,d),e=checkSameProtocolOrigin(e),f=c.substring(d+1),g=getXMLHttpRequest();xHRsInProgress[b]=g;g.open("POST",e,!0);g.onreadystatechange=function(){4==g.readyState&&(delete xHRsInProgress[b],doCommandsInClientDomain(pepareResponseData(b,g),b))};var h;try{h=JSON.parse(a[5])}catch(l){}if(h&&"object"===typeof h)for(var k in h)g.setRequestHeader(k,h[k]);g.setRequestHeader("Content-type","application/x-www-form-urlencoded");
g.send(f)}catch(l){handleError(b,l)}}function doPOSTJSONCommand(a){var b=a[1];try{var c=decodeURIComponent(a[4]),d=c.indexOf("?"),e=c.substring(0,d),e=checkSameProtocolOrigin(e),f=c.substring(d+1),g=getXMLHttpRequest();xHRsInProgress[b]=g;g.open("POST",e,!0);g.onreadystatechange=function(){4==g.readyState&&(delete xHRsInProgress[b],doCommandsInClientDomain(pepareResponseData(b,g),b))};g.setRequestHeader("Content-type","application/json;charset=UTF-8");g.send(f)}catch(h){handleError(b,h)}}
function doCBAUTHCommand(a){var b,c=a[0],d=a[1],e=a[2],f=PersistentStorage.getInstance();try{var g=COOKIE_COBROWSE,h=parseInt(a[5]);if(isNaN(h))logger.log("Wrong value for cbAuth cookie");else{var k=a[7];f.setItem(g+"_"+e,JSON.stringify({auth:h}),k,function(){f.getItem(g+"_"+e,function(a){b={resp:a,id:d,action:"auth"};doCommandsInClientDomain(JSON.stringify(b),d)})})}}catch(l){a="Response: "+c+", Id: "+d+'", Log: "'+catchJsFormatter(l,c),handleError(d,a)}}
function doCBCheckCommand(a){var b,c=a[0],d=a[1];a=a[2];var e=PersistentStorage.getInstance();try{e.getItem("cobrowse_"+a,function(a){b={resp:a,id:d,action:"auth"};doCommandsInClientDomain(JSON.stringify(b),d)})}catch(f){c="Response: "+c+", Id: "+d+'", Log: "'+catchJsFormatter(f,c),handleError(d,c)}}
function doChatActiveCommand(a){PersistentStorage.getInstance();try{var b=a[2],c=parseStringToBoolean(a[3]),d=1E3*parseInt(a[4]),e="inqCA_"+b;a=c?2:1;setChatActiveFlag(e,a,"");caUnloadController||(caUnloadController=new UnloadController(function(a){getChatActiveFlag(e,function(a){var c=caUnloadController.get();0!=c&&a==c&&(setChatActiveFlag(e,0,""),updateCookieLastTouched(b,d))})},null,a));caUnloadController.activate();onPageHidden(function(){updateCookieLastTouched(b,d)})}catch(f){}}
function updateCookieLastTouched(a,b){var c=PersistentStorage.getInstance(),d="inqLT_"+a,e=""+(new Date).getTime();c.setItem(d,e,b,function(){c.onUnload()})}function onPageHidden(a){_addEventListener(document,"visibilitychange",function(b){"hidden"===document.visibilityState&&a()})}function chatDeactivate(a){var b=a[1];a="inqCA_"+a[2];caUnloadController&&caUnloadController.deactivate();if("UNLOAD_HANDLER"!==b)try{setChatActiveFlag(a,0,"")}catch(c){}}
function doPostSyncCommand(a){var b=a[1];try{var c=decodeURIComponent(a[4]),d=c.indexOf("?"),e=c.substring(0,d),e=checkSameProtocolOrigin(e),f=c.substring(d+1),g=getXMLHttpRequest();xHRsInProgress[b]=g;g.open("POST",e,!1);g.setRequestHeader("Content-type","application/x-www-form-urlencoded");var h;try{h=JSON.parse(a[5])}catch(l){}if(h&&"object"===typeof h)for(var k in h)g.setRequestHeader(k,h[k]);g.send(f);delete xHRsInProgress[b];doCommandsInClientDomain(pepareResponseData(b,g),b)}catch(l){handleError(b,
l)}}function getAllData(a){if("function"!==typeof a)throw Error("Callback is required parameter for getAllData function");var b=PersistentStorage.getInstance("cookie"),c=b.getAllCookies().concat("; "),b=PersistentStorage.getInstance("localStorage"),c=c+b.getAllCookies(),b=PersistentStorage.getInstance("sessionStorage"),c=c+b.getAllCookies();a(c)}
function clearAllData(){var a=PersistentStorage.getInstance("cookie");a.clear();a=PersistentStorage.getInstance("localStorage");a.clear();a=PersistentStorage.getInstance("sessionStorage");a.clear()}function doClearStorageCommand(){"localStorage"===PersistentStorage.getDefaultUsedStorageType()&&PersistentStorage.getInstance("cookie").cleanNuanceCookies()}whenLoaded();function getXMLHttpRequest(){if(window.XMLHttpRequest)return new XMLHttpRequest;if(window.ActiveXObject)return new ActiveXObject("Microsoft.XMLHTTP");throw Error("Impossible to create XMLHttpRequest object.");}function setTimeoutXHR(a,b,c){if(0<a&&c)return setTimeout(function(){c[b]&&c[b].abort()},a)}function catchJsFormatter(a,b){try{return"ERROR while processing "+b+": "+a.name+" - "+a.message+" . Stack "+a.stack}catch(c){return""}}
function parseStringToBoolean(a){return"string"==typeof a?"true"==a:a}function _addEventListener(a,b,c,d){d||(d=!1);window.addEventListener?a.addEventListener(b,c,d):window.attachEvent&&a.attachEvent("on"+b,c)}function getLocation(){return window.location}function sendBeacon(a,b){a+="&timestamp="+(new Date).getTime();navigator.sendBeacon?navigator.sendBeacon(a,b):sendBeaconByXHR(a,b)}
function sendBeaconByXHR(a,b){var c=new XMLHttpRequest;c.open("POST",a,!1);c.setRequestHeader("Content-Type","text/plain;charset=UTF-8");c.send(b)};function UnloadController(a,b,c){this.active=!1;this.handler=a;this._value=c||null;if(b)for(var d in b)this[d]=b[d]}UnloadController.prototype.activate=function(){if(!this.onunload){this.onunload=function(a){this.isActive()&&(this.handler(a),this.deactivate())};var a=this;this._addUnloadHandler(function(b){b=b||window.event;a.onunload(b)})}this.active=!0};UnloadController.prototype.deactivate=function(){this.active=!1};UnloadController.prototype.isActive=function(){return this.active};
UnloadController.prototype.set=function(a){this._value=a};UnloadController.prototype.get=function(){return this._value};UnloadController.prototype._addUnloadHandler=function(a,b){_addEventListener(window,"unload",a,b);_addEventListener(window,"beforeunload",a,b);_addEventListener(window,"pagehide",a,b)};
